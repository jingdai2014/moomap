{% extends "layout.html" %}
{% block body %}
<div>
	<div class="title-text">Class Map</div>
	<select name="time" id="time" class="form-control" style="width:720px;margin:auto;">
		{% for tg in timeGroup %}
			{% if tg[1] == mapTime%}
			<option value={{tg[0]}} selected>{{tg[1]}}</option>
			{% else %}
			<option value={{tg[0]}}>{{tg[1]}}</option>
			{% endif %}
		{% endfor %}
	</select>
	<input type="text" name="classid" id="classid" value="{{classId}}" style="opacity:0;">

	<div id="heatmapContainerWrapper">
    </div>

    </br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br></br>

	<div>
		<form id="heatmapform">
	      	<label style="width:24%;display: inline-block;font-size: 25px;"><input type="radio" name="options" id="pa" value="pa" checked="checked"> Positive Affect</label>
			<label style="width:24%;display: inline-block;font-size: 25px;"><input type="radio" name="options" id="na" value="na"> Negative Affect</label>
		</form>
	</div>
	<div id="testAjax">
	</div>
</div>
{% endblock %}
{% block script %}
<script src="{{ url_for('static', filename='js/classmap.js')}}"></script>
<script type="text/javascript">
	var promise = new Promise(function(resolve, reject) {
	  resolve();
	});

	promise.then(function() {
	  $(document).ready(function(){
		reloadHeatmap();
	  });
	});

	$('#heatmapform input').on('change', function(){
		reloadHeatmap();
	});

	$('#time').change(function() {
		reloadHeatmap()
	});

	function reloadHeatmap() {
		var opt = $('input[name="options"]:checked', '#heatmapform').val();
		var mapTime = $('#time').val();
		var classId = $('#classid').val();
		$( "#heatmapContainerWrapper" ).load( "/heatmap", {time: mapTime, classid: classId, optType: opt});
	}
	// onchange="this.form.submit()"
</script>

{% endblock %}